# CPABE-AC17-Scheme
Ciphertext Policy Attribute Based Encryption - AC17 Scheme Library for C/C++ in Windows

## Prerequisites

- [CryptoPP Library](https://github.com/weidai11/cryptopp)
- [CP-ABE AC17 Scheme](https://eprint.iacr.org/2017/807)
- [Rabe-ffi](https://github.com/Aya0wind/Rabe-ffi)
## Installation for Windows

1. Clone the repository:
    ```sh
    git clone https://github.com/WanThinnn/CPABE-AC17-Scheme.git
    ```
2. Navigate to the project directory:
    ```sh
    cd CPABE-AC17-Scheme/cpp-sources
    code . #for open projects Visual Studio Code
    ```
3. Configure `tasks.json` to build the project using `cl.exe`:
    - Create or open the `.vscode` folder in your project directory.
    - Create a `tasks.json` file inside the `.vscode` folder with the following content:
      ```json
      {
        "version": "2.0.0",
        "tasks": [
          {
            "label": "Build CP-ABE Lib with cl.exe",
            "type": "shell",
            "command": "cl.exe",
            "args": [
              "/MD",
              "/GS",
              "/O2",
              "/Zi",
              "/EHsc",
              //"/LD",  // Add this parameter to create DLL
              //"/DBUILD_DLL", // Add this parameter to create DLL
              //"/Fe:${fileDirname}\\${fileBasenameNoExtension}.dll",
              "/Fe:${fileDirname}\\${fileBasenameNoExtension}.exe",
              "${file}",
              "/I${workspaceFolder}\\include",
              "/link",
              "/LIBPATH:${workspaceFolder}\\lib\\static-lib",
              "rabe_ffi.lib",
              "cryptlib.lib",
              "bcrypt.lib",
              "advapi32.lib",
              "ntdll.lib",
              "/MACHINE:X64"
            ],
            "problemMatcher": ["$msCompile"],
            "group": {
              "kind": "build",
              "isDefault": true
            },
            "detail": "Task generated by Debugger."
          }
        ]
      }
      ```

4. Build the project:
    - Open Visual Studio Code and open your project.
    - Press `Ctrl+Shift+B` to run the configured build task.
    - If everything is configured correctly, your program will be compiled using `cl.exe`.

## Usage

### Using the Executable

To use the pre-built executable, navigate to the `CPABE-AC17-Scheme/main` directory and run the `ac17_cli_app.exe` file:

```sh
cd CPABE-AC17-Scheme/main
.\ac17_cli_app.exe
```


The usage of the executable is as follows:
```sh
Usage: ac17_cli_app.exe [setup|genkey|encrypt|decrypt]
Usage: ac17_cli_app.exe setup <path_to_save_file> <format:HEX/Base64/JsonText>
Usage: ac17_cli_app.exe genkey <public_key_file> <master_key_file> <attributes> <private_key_file> <format:HEX/Base64/JsonText>
Usage: ac17_cli_app.exe encrypt <public_key_file> <plaintext_file> <policy> <ciphertext_file> <format:HEX/Base64/JsonText>
Usage: ac17_cli_app.exe decrypt <public_key_file> <private_key_file> <ciphertext_file> <recovertext_file> <format:HEX/Base64/JsonText>
```

Example commands:
```sh
.\ac17_cli_app.exe setup "test_case" Base64
.\ac17_cli_app.exe genkey "test_case/public_key.key" "test_case/master_key.key" "A B C" "test_case/private_key.key" Base64
.\ac17_cli_app.exe encrypt "test_case/public_key.key" "test_case/plaintext.txt" "((A and C) or E)" "test_case/ciphertext.txt" Base64
.\ac17_cli_app.exe decrypt "test_case/public_key.key" "test_case/private_key.key" "test_case/ciphertext.txt" "test_case/recovertext.txt" Base64
```
### Integrating the Library
After building the library, you can integrate it into any program on Windows. Here are the steps to include the library in your project.
Please go to <b>python-sources</b> folder to see more.

## Acknowledgements
Special thanks to [Aya0wind](https://github.com/Aya0wind) for the [Rabe-ffi](https://github.com/Aya0wind/Rabe-ffi) project, which was instrumental in building this library.

## License

This project is licensed under the MIT License, a permissive open-source license that allows anyone to use, modify, and distribute the code. We encourage you to clone, fork, and contribute to this project to help improve and expand its capabilities.

By contributing to this project, you agree that your contributions will be licensed under the same MIT License.

For more details, please refer to the [LICENSE](LICENSE) file.